# 1.3 Отличительные особенности блокчейна Waves

Если у вас уже есть опыт работы с другими блокчейнами, вам может быть интересно, чем же отличается Waves от условного Ethereum и почему он другой. Давайте быстро пройдемся по отличиям, которые будут детально рассматриваться в следующих разделах.

## Работа с токенами/ассетами

Одной из особенностей работы с Waves с первого дня была простота выпуска токенов. Для этого достаточно отправить транзакцию или [заполнить форму из 5 полей](https://docs.waves.exchange/en/waves-exchange/waves-exchange-online-desktop/online-desktop-asset/online-desktop-token-creation)) в любом UI клиенте.
Выпущенный токен автоматически становится доступен для переводов, торговки на DEX, использования в dApp и сжигания.

<!-- добавить ссылку на раздел про токены. -->

В отличие от Ethereum, в Waves токены не являются смарт-контрактами, а являются "гражданами первого сорта", то есть являются отдельной полноценной сущностью. У этого есть как преимущества, так и недостатки, о которых мы поговорим в разделе [4 "Токены"]()

## Транзакции

Другая отличительная особенность Waves заключается в наличии большого количества типов транзакций. Например, в Ethereum есть смарт-контракты, которые могут являться чем угодно, в зависимости от их реализации. ERC-20, описывающий токен, это просто описание интерфейса смарт контракта, какие методы он должен иметь. В Waves это не так, т.к. подразумеватся, что лучше иметь легковесные/узкие специфичные вещи, чем абстрактные вещи "обо всем и ни о чем". Специфичность примитивов упрощает во многих местах разработку, но это иногда является менее гибким решением.

Ниже представлен список актуальных транзакций на момент написания этих строк:

![Waves transaction types](./assets/1-3-1&#32;transactions.png "Waves Transaction Types")

## Fair PoS

В Waves используется алгоритм Proof-of-Stake для определения права на генерацию блока. Блоки генерируются в среднем каждую минуту, а вероятность генерации блока нодой зависит от 3 параметров:

- Генерирующего баланса ноды, то есть баланса самой ноды + количества токенов, которые сдали ей в лизинг.
- Текущего времени и рандома (великий рандом есть всегда в жизни!)
- Генерящего баланса сети, ведь не все токены в сети участвуют в генерации блоков, они могут быть в ордерах на биржах или лежать на холодных кошельках.

Чтобы начать генерировать блоки достаточно иметь 1000 Waves генерирующего баланса (свои + полученные в лизинг). Зачем вам генерировать блоки? За каждый блок нода получает на свой баланс комиссии из транзакций в этом блоке и вознаграждение "из воздуха". Оба этих момента не такие простые, так что рассмотрим их чуть позже.

Очень частый вопрос, который встречается - сколько блоков я буду генерировать в месяц с балансом N. Точное числе предсказать невозможно, так как зависит от случайностей и изменений в сети, но примерно предсказать можн. Чтобы сделать это надо знать текущие параметры сети:

1. *Сколько токенов Waves участвуют в генерации блоков?* Это так называемый генерирующий баланс сети в целом. Для легкости рассчета скажем, что 50 млн токенов участвуют в генерации блоков.
2. *Какой баланс нашей ноды?* То есть сколько у нас своих токенов на аккаунте ноды и сколько нам сдали в лизинг. В нашем случае возьмем генерирующий баланс равный 10 000 Waves.
3. Среднее время блока составляет 1 минуту, то есть в сети генерируется примерно 1440 блоков в день или 43200 блоков в месяц.

Для вычисления примерного количества блоков, которые мы сгенерируем, делим количество блоков за период на генерирующий баланс сети и умножаем на наш баланс:

$ForgedBlocks = BlocksCountInPeriod / NetworkGenBalance * NodeGenBalance$

Сделав нехитрые вычисления получаем:

`43200 / 50000000 * 10000 = 8.64`

То есть, в среднем нода будет генерировать 8-9 транзакций в месяц, если будет работать стабильно и параметры сети не изменятся, но, такого, конечно, не бывает, ведь в сети постоянно делается большое количество транзакций.

## Leasing

В Waves есть механизм стейкинга, который называется leasing. Любой владелец токена Waves может отправить токены в лизинг любой ноде Waves, чтобы та производила блоки "от имени этих токенов". Лизингодатель передает право на генерацию блоков от имени его токенов лизингополучателю (владельцу ноды). Обычно это делается, когда пользователь не хочет или не может заниматься разворачиваем своей ноды и ее поддержкой. Обычно владельцы лизнговых пулов выплачивают бОльшую часть заработанного за счет лизинга средств лизингодателям. Отправить в лизинг средства можно моментально, но в генерируюющем балансе ноды они начнут учитываться только через 1000 блоков.

Забрать токены из лизинга можно моментально.

## Community driven monetary policy

Первое время в Waves была ограниченная эмиссия в 100 млн токенов, которые были выпущены сразу на момент запуска мейннета, но с осени 2019 года в комьюнити решили, что для дальнейшего роста экосистемы лучше будет при наличии эмиссии токенов. То есть в каждом новом блоке появляются новые токены Waves. Какое именно количество токенов определяется сообществом, которое голосует за размер вознаграждения каждые 100 тысяч блоков. На момент написания этих строк вознаграждение за блок составляло 6 Waves. При этом гарантируется, что каждый период голосования размер вознаграждения не может изменяться больше, чем на 0.5 Waves.

## Sponsorship

Функция спонсирования токена является способом снижения входных барьеров для пользователей. Суть в том, что аккаунт, выпустивший токен, может спонсировать транзакции с этим токеном. Представим, есть токен А, его выпустил Cooper и включил спонсирование. Например, Alice заработала 100 токенов A и хочет 10 из них отпраивть Bob. Мы то с вами знаем, что для каждой транзакции в блокчейне необхоодимо платить комиссию, в сети Waves майнеры принимают только Waves в виде комиссии, а у Alice нет Waves. Придется идти покупать Waves как-то?

Нет. Спонсорство токена позволяет владельцу токена сказать, что он готов взять на себя комиссии за операции с этим токеном (токеном А в нашем случае). Владельцы токена А при отправке транзакции будут платить этот же токен в виде комиссии.  В нашем примере, Alice сможет указать в своей транзакции, что получатель Bob, количество для отправления - 10 токенов A, комиссия - 5 токенов A. В итоге с ее аккаунта спишется 15 токенов, 10 получит Bob, 5 получит Cooper, как выпустивший и спонсирующий токен, а майнер получит Waves c аккаунта Cooper'а.

Почему Alice заплатит 5 токенов и сколько получит майнер? Поговорим об этом в следующих главах. Главное, что сейчас необходимо запомнить - **в Waves существуют способы сделать транзакции не имея токенов Waves у себя на балансе.**

## Ride и смарт контракты
<!-- TODO: добавить ссылку на раздел 6 -->

Waves является блокчейном общего назначения, не специализирующемся на чем-то одном, поэтому появление смарт-контрактов стало логичным продолжением развития платформы. Про смарт-контракты в Waves мы поговорим в разделе [6 "Ride"](). Сейчас стоит отметить, что контракты пишутся на языке Ride, который был придуман специально для смарт-контрактов и является не Тьюринг-полным. В языке нет циклов, но зато нет газа, не бывает failed транзакций в блокчейн, стоимость транзакции всегда известна заранее. Заинтриговал? Это ведь только начало, мы поговорим про модель исполнения Ride и синтаксис языка позже.

## Waves NG

Чуть раньше я уже [затрагивал тему](./1.1%20History%20of%20Waves.md), связанную с Waves NG и упоминал, что она позволяет транзакциям быстрее попадать в блоки и работать блокчейну так быстро, что платформа в состоянии обрабатывать сотни транзакций в секунду в основной сети. А там, на минуточку, больше 400 нод, распределенных по всему миру, на совершенно разном железе и пропускной способностью.

![Waves nodes map](./assets/1-3-2&#32;Nodes&#32;on&#32;the&#32;map.png "Waves nodes map")

## DEX

Легкий и быстрый выпуск токенов наряду с "классовым равенством" (помните, что токены являются гражданами первого сорта?) позволяет сделать торговлю токенами простой. Нода Waves (речь про версию на Scala) поддерживает возможность создания расширений, одним из таких расширений является матчер. Матчер принимает ордера на покупку и продажу токенов и хранит их (централизованно). Например, Alice хочет продать токен wBTC и купить Waves, а Bob наоборот. Они формируют ордера (криптографически подписанные примитивы) и отправляют их в матчер, который определяет, что эти ордера выставлены в одной паре и их можно сматчить по определенной цене. В результате матчер формирует Exchange транзакцию, которая содержит 2 ордера (один от Alice, другой от Bob) и отправляет в блокчейн. При этом, матчер забирает себе комиссию, нода, которая смайнит блок с Exchange транзаций, тоже получает комиссию.

![How does DEX work](./assets/1-3-3&#32;how&#32;dex&#32;works.png "How does DEX work")
