# Обычные аккаунты vs. смарт аккаунты

Как вы уже наверняка поняли из предыдущего раздела, в Waves используется модель аккаунтов, а не входов и выходов (input и output) как в Bitcoin. Но отличия модели Waves есть не только от Bitcoin, но, например, и от Ethereum, где тоже есть аккаунты. Основное отличие в том, что в Waves есть несколько типов аккаунтов. Давайте разберем их по порядку.

## Обычные аккаунты

Работа обычных аккаунтов максимальна проста и интуитивно понятна. Каждый аккаунт (с неким публичным ключом) "обладает" некими токенами и сохраняет данные в свое хранилще. Чтобы сделать действие с аккаунта, необходимо сформировать транзакцию, подписать приватным ключом этого аккаунта и отправить в сеть. **Валидная подпись транзакции позволяет делать операции с этого аккаунта.** Ноды при валидации транзакции фактически прооверяют соответствие подписи и тела транзакции. Так же они должны проверить некоторые параметры из блокчейна, например, если аккаунт хочет отправить токены, есть ли они у него на балансе. Проще всего понять принцип работы с помощью аналогии - аккаунт явлется амбаром, с которым можно сделать что угодно (унести оттуда <s>сыр</s> токены, например), если есть ключ от амбарного замка.

Но обычный аккаунт можно превратить в смарт-аккаунт, который ведет себя по-другому.

## Смарт аккаунт

Если на обычный аккаунт поставить скрипт, который задает другие правила валидации **исходящих** транзакций, то он станет **смарт-аккаунтом.** Смарт-аккаунт так же будет "владеть" токенами, но чтобы что-то с ними сделать (перевести, сжечь, обменять и т.д.) надо не предоставить подпись, а удовлетворять условиям, описанным в теле скрипта. Модель во многом похожа на то, что есть в Bitcoin, за одним исключением - в Waves используется не примитивный Bitcoin script, а гораздо более мощный язык Ride. В этой книге будет отдельный раздел, посвященный Ride, поэтому сейчас больше поговорим про концепцию смарт-аккаунтов. Код на Ride отправляется в сеть с помощью транзакции установки скрипта (`SetScript`) и превращает обычный аккаунт в смарт.

Смарт-аккаунты являются разновидностью смарт-контрактов. В целом можно выделить 3 вида смарт-контрактов, которые встречаются в природе:

- Простые смарт-контракты для упраления аккаунтами (мультиподпись, эскроу и т.д.)
- Сложные контракты с нетривиальной логикой (Crypto-Kitties, Bancor и т.д.)
- Контракты токенов (ERC-20, ERC-721)

Смарт-аккаунты являются представителями первой категории, будучи предназначенными для базовых операций с аккаунтом. В Waves есть инструменты для создания сложных контрактов, которые будут рассмотрены в разделе 6, а для создания токенов в Waves вообще не требуются контракты, что так же рассмотрим в главе 4.

Смарт-аккаунты **позволяют валидировать только исходящие транзакции** (не входящие). Скрипт смарт-контракта является предикатом, который выполняется при попытке отправить транзакцию с аккаунта, и транзакция считается валидной только в том случае, если тело скрипта возвращает `true`. Тело скрипта может содержать различную логику, опирающуюся на:

- Параметры транзакции (например, размер комиссии, получатель транзакции перевода, тип транзакции и т.д.)
- Данные из блокчейна (номер последнего блока в блокчейне, данные из хранилища **любого** аккаунта)
- Подписи транзакции

Продолжая аналогию с амбаром, можно сказать, что смарт-аккаунт является амбаром с другим типом замка, который открывается не по ключу (или не только по ключу), но и может опираться на время, содержимое амбара (или любых других амбаров), личность открывающего и т.д. Думаю, многие амбары во многих колхозах были бы в большей безопасности, если там были замки, открыть которые можно только 5 ключами от разных людей.

## Когда использовать смарт-аккаунты

Смарт-аккаунты очень легковесны, не требуют много вычислительных мощностей от нод, в то же время покрывает большое количество кейсов. Самыми частыми случаями использования смарт-аккаунтов являются:

- **Мультиподпись.** Например, есть аккаунт с токенами от 3 сторон, и тратить их можно только если согласны 2 стороны из 3.
- **Эскроу.** Часто при совершении операций в реальной жизни между 2 сторонами необходимо наличие некоего арбитра, который фиксирует факт совершения действия с одной стороны и необходимость передачи ей денег. Продажа квартиры - отличный пример, где при передаче ключей необходимо передавать деньги. Такое можно реализовать с помощью эскроу контракта.
- **Атомарный обмен.** Обмен токенов в двух сетях, когда токены блокируются сторонами в 2 различных сетях с помощью секрета. Как только одна сторона разблокирует токены в сети А секретом, вторая увидит этот секрет и сможет забрать токены в сети Б.
